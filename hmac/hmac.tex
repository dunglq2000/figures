\documentclass{standalone}
\usepackage{tikz}

%%% Custom TikZ addons
\usetikzlibrary{crypto.symbols, shapes, positioning}
\tikzset{shadows=no}        % Option: add shadows to XOR, ADD, etc.

%% Document
\begin{document}
\begin{tikzpicture}[scale=1]


	% Inner function
	\node (iput) at ( 1, 2) {$M$};

	\node[XOR,thick] (ixor) at (-1, 2) {};
	\draw[edge] (-2, 2) node[left] {$K$} -- (ixor.west);
	\draw[edge] (-1, 3) node[above] {$\mathit{ipad}$} -- (ixor.north);


	\node[draw,trapezium,trapezium left angle=-70,trapezium right angle=-70,scale=2] (iH) at (0, 0) {$H$};

	\draw[edge] (ixor.east) -| (iH.north);
	\draw[edge] (iput.west) -| (iH.north);



	% Outer function
	\node[XOR,thick] (oxor) at (-2, -1) {};
	\draw[edge] (-3, -1) node[left] {$K$} -- (oxor.west);
	\draw[edge] (-2, 0) node[above] {$\mathit{opad}$} -- (oxor.north);


	\node[draw,trapezium,trapezium left angle=-70,trapezium right angle=-70,scale=2] (oH) at (-1, -3) {$H$};

	\draw[edge] (oxor.east) -| (oH.north);
	\draw[edge] (iH.south) -- (0, -1) -| (oH.north);

	% Output
	\draw[edge] (oH.south) -- ++(0, -1) node[below] {$\mathrm{HMAC}_K(M)$};

\end{tikzpicture}
\end{document}