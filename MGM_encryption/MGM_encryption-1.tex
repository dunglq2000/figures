\documentclass[tikz]{standalone}
\usepackage{tikz}
\usepackage{amsmath, amsfonts}

\usetikzlibrary{calc, positioning}
\newcommand{\Enc}{\mathsf{Enc}}

\begin{document}
% \begin{tikzpicture}

% \foreach \x in {0,1,2} {
%     \node (f\x) at ($\x*(5cm,0)$) [minimum size=0.75cm, minimum height=1.0cm, rounded corners=1ex,fill=red!10,draw] {Counter$_\x$};
%     \node (c\x) [minimum size=0.75cm, minimum height=1.0cm, rounded corners=1ex,fill=red!40,draw] [below of=f\x, node distance=1.5cm] {$\text{Enc}_K$};
%     \draw[-latex] (f\x) -- (c\x);
% }

% \node (incr1) [minimum size=0.5cm,minimum size=0.75cm, rounded corners=1ex,draw][right of=f0, node distance=2.5cm] {incr};
% \node (incr2) [minimum size=0.5cm,minimum size=0.75cm, rounded corners=1ex,draw][right of=f1, node distance=2.5cm] {incr};
% \draw[-latex] (f0) -- (incr1);
% \draw[-latex] (incr1) -- (f1);
% \draw[-latex] (f1) -- (incr2);
% \draw[-latex] (incr2) -- (f2);

% \foreach \x in {1, 2} {
%     \node (p\x) [below of=c\x, node distance=1.3cm, circle, draw] {};
%     \node (m\x) [below of=p\x, node distance=1.3cm, minimum size=0.75cm, minimum height=1.0cm, rounded corners=1ex, fill=red!10, draw] {$C_\x$};
%     \node (k\x) [below of=m\x, node distance=1.3cm, circle, draw] {};
%     \draw[-] (p\x.north) -- (p\x.south);
%     \draw[-] (p\x.east) -- (p\x.west);
%     \draw[-] (k\x.north) -- (k\x.south);
%     \draw[-] (k\x.east) -- (k\x.west);
%     \draw[-latex] (p\x) -- (m\x);
%     \draw[-latex] (m\x) -- (k\x);
% }

% \node (b1) [right of=k1, node distance=2.5cm, minimum size=0.75cm, rounded corners=1ex, draw] {mult$_H$};
% \node (b2) [below of=k2, node distance=1.3cm, minimum size=0.75cm, rounded corners=1ex, draw] {mult$_H$};
% \draw[-latex] (k1) -- (b1);
% \draw[-latex] (k2) -- (b2);

% \draw[-latex] (c1) -- (p1);
% \draw[-latex] (c2) -- (p2);
% \node (iv1) [left of=p1, node distance=1.5cm, minimum size=0.75cm, minimum height=1.0cm, rounded corners=1ex, fill=red!10, draw] {$P_1$};
% \draw[-latex] (iv1) -- (p1);
% \node (iv2) [left of=p2, node distance=1.5cm, minimum size=0.75cm, minimum height=1.0cm, rounded corners=1ex, fill=red!10, draw] {$P_2$};
% \draw[-latex] (iv2) -- (p2);

% \node (bb) [left of=k1, node distance=1.4cm, minimum size=0.75cm, rounded corners=1ex, draw] {mult$_H$};
% \node (ad) [left of=bb, node distance=2.2cm, minimum size=0.75cm, minimum height=1.0cm, rounded corners=1ex, fill=red!10, draw] {Auth Data};

% \draw[-latex] (bb) -- (k1);
% \draw[-latex] (ad) -- (bb);

% \node (circ1) [below of=b2, node distance=1.3cm, circle, draw] {};
% \node (bbb) [below of=circ1, node distance=1.3cm, minimum size=0.75cm, rounded corners=1ex, draw] {mult$_H$};
% \node (circ2) [below of=bbb, node distance=1.3cm, circle, draw] {};
% \node (at) [below of=circ2, node distance=1.3cm, minimum size=2cm, minimum height=1.0cm, rounded corners=1ex, fill=red!10, draw] {Auth Tag};
% \node (concat) [left of=circ1, node distance=2.0cm, minimum size=0.75cm, minimum height=1.0cm, rounded corners=1ex, fill=red!10, draw] {len($A$)$||$len($C$)};

% \draw[-latex] (b2) -- (circ1);
% \draw[-latex] (circ1) -- (bbb);
% \draw[-latex] (bbb) -- (circ2);
% \draw[-latex] (circ2) -- (at);
% \draw[-] (circ1.north) -- (circ1.south);
% \draw[-] (circ1.east) -- (circ1.west);
% \draw[-] (circ2.north) -- (circ2.south);
% \draw[-] (circ2.east) -- (circ2.west);
% \draw[-latex] (concat) -- (circ1);
% \draw[-latex] (b1) -- (k2);
% \draw[-latex] ($(c0)+(0,-0.5cm)$) |- ($(circ2) + (-0.2cm,0cm)$);

% \end{tikzpicture}

\begin{tikzpicture}
    \node (n0) at (0,0) [minimum width=0.5cm, minimum height=0.75cm] {$0 \Vert \text{nonce}$};
    \node (E) at (2,0) [minimum width=0.5cm, minimum height=0.75cm, draw] {$\Enc_K$};
    \foreach \x in {1, 2}
    {
        \node (Y\x) at ($\x*(3.5,0)$) [minimum width=0.5cm, minimum height=0.75cm, draw] {$Y_\x$};
        \node (E\x) [below=0.75cm of Y\x, minimum width=0.5cm, minimum height=0.75cm, draw] {$\Enc_K$};
        \node (x\x) [below=0.75cm of E\x, circle, draw] {};
        \node (p\x) [left=0.75cm of x\x] {$P_\x$};
        \node (c\x) [below=0.75cm of x\x] {$C_\x$};
        \draw[-latex] (Y\x.south) -- (E\x.north);
        \draw[-latex] (E\x.south) -- (x\x.north);
        \draw[-latex] (p\x.east) -- (x\x.west);
        \draw[-latex] (x\x.south) -- (c\x.north);
        \draw (x\x.north) -- (x\x.south);
        \draw (x\x.east) -- (x\x.west);
    }
    \draw[-latex] (n0.east) -- (E.west);
    \draw[-latex] (E.east) -- (Y1.west);
    \draw[-latex] (Y1.east) -- node [above] {incr} (Y2.west);

    \foreach \x in {1, 2, 3, 4}
    {
        \node (H\x) at ($\x*(3.5,0)+(-4.5,-5)$)  [minimum width=0.5cm, minimum height=0.75cm] {$H_\x$};
        \node (t\x) at ($\x*(3.5,0)+(-3.5,-5)$) [circle, draw] {};
        \node (o\x) at ($\x*(3.5,0)+(-3.5,-6)$) [circle, draw] {};

        \draw (t\x.north west) -- (t\x.south east);
        \draw (t\x.north east) -- (t\x.south west);
        \draw (o\x.north) -- (o\x.south);
        \draw (o\x.west) -- (o\x.east);

        \draw[-latex] (H\x.east) -- (t\x.west);
        \draw[-latex] (t\x.south) -- (o\x.north);   
    }

    \node (A) [above=0.5cm of t1, minimum width=0.5cm, minimum height=0.75cm] {$A$};
    \node (L) [above=0.5cm of t4, minimum width=0.5cm, minimum height=0.75cm] {$\text{len}(A) \Vert \text{len}(C)$};

    \draw[-latex] (A.south) -- (t1.north);
    \draw[-latex] (L.south) -- (t4.north);

    \draw[-latex] (c1.south) -- (t2.north);
    \draw[-latex] (c2.south) -- (t3.north);

    \draw[-latex] (o1.east) -- (o2.west);
    \draw[-latex] (o2.east) -- (o3.west);
    \draw[-latex] (o3.east) -- (o4.west);

    \node (Eq) [below=0.5cm of o4, minimum width=0.5cm, minimum height=0.75cm, draw] {$\Enc_K$};
    \node (msb) [below=0.5cm of Eq, minimum width=0.5cm, minimum height=0.75cm, draw] {$\text{MSB}_S$};
    \node (T) [below=0.5cm of msb, minimum width=0.5cm, minimum height=0.75cm] {$T$};

    \draw[-latex] (o4.south) -- (Eq.north);
    \draw[-latex] (Eq.south) -- (msb.north);
    \draw[-latex] (msb.south) -- (T.north);
\end{tikzpicture}
\end{document}